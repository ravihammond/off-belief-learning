mkdir -p /private/home/hengyuan/HanabiModels/icml_run3_OBL1/OFF_BELIEF1_SHUFFLE_COLOR0_BZA0_BELIEF_a
sbatch --job-name OFF_BELIEF1_SHUFFLE_COLOR0_BZA0_BELIEF_a \
       --mem 350G \
       --partition priority \
       -C volta16gb \
       --gres gpu:3 \
       --nodes 1 \
       --ntasks-per-node 1 \
       --cpus-per-task 45 \
       --output /private/home/hengyuan/HanabiModels/icml_run3_OBL1/OFF_BELIEF1_SHUFFLE_COLOR0_BZA0_BELIEF_a/std.out \
       --error /private/home/hengyuan/HanabiModels/icml_run3_OBL1/OFF_BELIEF1_SHUFFLE_COLOR0_BZA0_BELIEF_a/std.err \
       --comment "critical_result_ICML2021" \
       --time 4320 \
       --wrap "
#!/bin/bash
python /private/home/hengyuan/OneHanabi/rl/pyhanabi/selfplay.py \
       --save_dir /private/home/hengyuan/HanabiModels/icml_run3_OBL1/OFF_BELIEF1_SHUFFLE_COLOR0_BZA0_BELIEF_a \
       --num_thread 80 \
       --num_game_per_thread 80 \
       --method vdn \
       --sad 0 \
       --act_base_eps 0.1 \
       --act_eps_alpha 7 \
       --lr 6.25e-05 \
       --eps 1.5e-05 \
       --grad_clip 5 \
       --gamma 0.999 \
       --seed 2254257 \
       --batchsize 128 \
       --burn_in_frames 10000 \
       --replay_buffer_size 100000 \
       --epoch_len 1000 \
       --num_epoch 5000 \
       --priority_exponent 0.9 \
       --priority_weight 0.6 \
       --train_bomb 0 \
       --eval_bomb 0 \
       --num_player 2 \
       --rnn_hid_dim 512 \
       --multi_step 3 \
       --train_device cuda:0 \
       --act_device cuda:1 \
       --shuffle_obs 0 \
       --shuffle_color 0 \
       --num_lstm_layer 2 \
       --boltzmann_act 0 \
       --pred_weight 0.25 \
       --pred_weight2 0.0 \
       --hide_action 0 \
       --min_t 0.01 \
       --max_t 0.1 \
       --min_color_r -1 \
       --max_color_r -1 \
       --num_color_r -1 \
       --discard_r 0 \
       --off_belief 1 \
       --num_fict_sample 10 \
       --belief_device cuda:2 \
       --belief_model /private/home/hengyuan/HanabiModels/icml_run2_b0/EXPLORE1_RAND1_LOAD0_SEEDa/latest.pthw \
       --load_model None \
"
